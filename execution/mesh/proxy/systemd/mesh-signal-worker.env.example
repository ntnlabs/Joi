# /etc/default/mesh-signal-worker
# Environment variables for Mesh Signal Worker service
# Copy to /etc/default/mesh-signal-worker and adjust as needed

# --- Signal Account (REQUIRED) ---
SIGNAL_ACCOUNT=+<COUNTRY><NUMBER>

# --- Signal CLI ---
SIGNAL_CLI_BIN=/usr/local/bin/signal-cli
SIGNAL_CLI_CONFIG_DIR=/var/lib/signal-cli

# --- Worker ---
MESH_WORKER_HTTP_PORT=8444
MESH_SIGNAL_POLL_SECONDS=5

# --- Forwarding to Joi ---
# Set to 1 to enable forwarding messages to Joi
MESH_ENABLE_FORWARD=1
# Joi API base URL (Nebula overlay IP - use 10.42.0.10 for Nebula, or 172.22.22.2 for direct vmbr1)
# All endpoints (/api/v1/message/inbound, /api/v1/document/ingest, etc.) are derived from this
MESH_JOI_URL=http://10.42.0.10:8443
# Timeout for Joi requests (LLM can be slow)
MESH_FORWARD_TIMEOUT=120

# --- HMAC Authentication (defense-in-depth over Nebula) ---
# Shared secret for HMAC signing (MUST match JOI_HMAC_SECRET on Joi VM)
# Generate with: openssl rand -hex 32
MESH_HMAC_SECRET=<your-256-bit-hex-secret>
# Timestamp tolerance in milliseconds (default: 300000 = 5 minutes)
# MESH_HMAC_TIMESTAMP_TOLERANCE_MS=300000
